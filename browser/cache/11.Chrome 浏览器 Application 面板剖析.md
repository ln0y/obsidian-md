---
aliases: []
tags: ['browser/cache', 'date/2023-08', 'year/2023', 'month/08']
date: 2023-08-24-星期四 17:44:13
update: 2023-08-24-星期四 17:44:40
---

在我们已经对浏览器缓存有了一定的认知和了解后，本文将从浏览器缓存分析及操作工具出发，从另一个角度加深大家对浏览器缓存的认识。

而提及前端浏览器工具，市面上再好用的工具也一定不如浏览器自带的开发者工具好用，如果是分析缓存相关的工具，那么自然而然就归属于开发者工具的 Application 面板了，该面板基本涵盖了浏览器存储型缓存的所有类别。下面我们还是以市场占有率最高的 Chorme 浏览器为例进行介绍。

## Application 面板介绍

Chrome Application 面板集成了对浏览器存储数据的一系列操作功能，比如清空存储数据、操作查看 Cookie / Web Storage、查看删除 IndexedDB、调试 Service Worker 等。

### 清空存储数据

清空浏览器存储数据是对于开发者而言比较常用的功能，我们可以在面板中的 Storage 菜单中进行操作：

![20211004211439.jpg](_attachment/img/6c5add1bb37693c635a4cf9f7d35ea4e_MD5.png)

我们可以点击 `Clear site data` 按钮进行当前站点存储数据的清空操作，当然也可以选择性的勾选需要清除的存储类型，比如 Service workers、Local and session storage、IndexedDB 等。

在该菜单中我们也可以在 `Usage` 栏下查看浏览器的总存储大小及目前已经被使用的容量。

### 操作查看 Cookie / Web Storage

操作查看 Cookie 也是我们常用的功能之一，在左侧 Cookies 菜单中我们选择当前站点的域名后便可以查看该站点所存储的 Cookie 数据。

![20211005140415.jpg](_attachment/img/1debf88be81e8b77ea92786f20a2362c_MD5.png)

顶部的功能区域从左往右依次为刷新、搜索、清空全部、删除选中和只展示有问题的 Cookies。而下方的列表区域我们可以查看、双击编辑和选择删除对应 Cookie 的数据值，同时在列表最后一行空白处双击后我们也可以进行 Cookie 的新增操作。

**注：当 Cookie 数据中对应的 HttpOnly 字段显示被勾选时，表示该 Cookie 不可通过 JS 获取和修改。**

Web Storage 的操作区域与 Cookie 类似，分别在 Local Storage 和 Session Storage 菜单下，同样具备查看、双击编辑、选择删除和新增功能。

![20211005142653.jpg](_attachment/img/19a19d2951724c46c795144f0f90c5e7_MD5.png)

### 查看删除 IndexedDB

如果当前网站存储了 IndexedDB 数据，那么你可以在对应的 IndexedDB 菜单下选择对应的数据库进行查看删除操作（不可在 Application 面板中新增修改）。

![20211005163122.jpg](_attachment/img/698d648515434887604fd04b63761944_MD5.png)

当只选中数据库名称时，右侧区域将展示该库所在的站点域名、版本号和下属的表的数量。同时也可以点击下方操作按钮进行库的删除和刷新操作。

![20211005152014.jpg](_attachment/img/78ac825bb9163492e4f4735bd2590b20_MD5.png)

当点击数据库中对应的表后右侧会展示该表中的数据内容，顶部的功能区域从左往右依次为刷新、上一页下一页、按照主键 key 搜索、清空表和删除选中行。

### 查看渐进式 Web 应用配置

渐进式 Web 应用（PWA）的配置也可以在 Application 面板中查看，比如和其相关的 Manifest 菜单。该菜单中展示的是 PWA 所需的 manifest.json 文件内容，用于告知浏览器如何在桌面上安装此应用及安装后应展示的信息。

![20211005161012.jpg](_attachment/img/25aa88948a79c92b1dc37a78f02764ad_MD5.png)

上图中指向展示信息项的对应 JSON 文件如下：

```json
{
  "name": "Google Developers",
  "short_name": "Google Developers",
  "start_url": "/",
  "display": "standalone",
  "orientation": "portrait",
  "background_color": "#fff",
  "theme_color": "#fff",
  "icons": [
    {
      "src": "icons/icon-72x72.png",
      "sizes": "72x72",
      "type": "image/png"
    },
    {
      "src": "icons/icon-96x96.png",
      "sizes": "96x96",
      "type": "image/png"
    },
    {
      "src": "icons/icon-128x128.png",
      "sizes": "128x128",
      "type": "image/png"
    },
    {
      "src": "icons/icon-144x144.png",
      "sizes": "144x144",
      "type": "image/png"
    },
    {
      "src": "icons/icon-152x152.png",
      "sizes": "152x152",
      "type": "image/png"
    },
    {
      "src": "icons/icon-192x192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "icons/icon-384x384.png",
      "sizes": "384x384",
      "type": "image/png"
    },
    {
      "src": "icons/icon-512x512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ],
  "splash_pages": null
}
```

这是一份标准的 manifest.json 文件，包含了应用名称、简写名称、背景色、主题色和应用各分辨率图标等的配置。

在访问支持 PWA 的网页时，浏览器地址栏右侧会出现一个安装图标，点击安装后可以将该站点以 APP 的方式安装到桌面上。如下图所示：

![20211005173602.jpg](_attachment/img/8a2ef1ea30ab345587ae75a671241419_MD5.png)

### 调试 Service Worker

Application 中的一大部分功能都和 Service Worker 有关，比如 Service Workers、Cache Storage 和 Background Services 菜单项和集合。

首先我们看一下 `Service Workers` 菜单中的内容：

![20211005174711.jpg](_attachment/img/e531ecaf1542be1c9d465a0d611fcc67_MD5.png)

顶部 3 个复选框分别代表离线、重载更新和绕过缓存从网络获取资源，我们可以勾选需要的功能进行测试。下方区域展示了 Service Worker 的脚本地址、最近接收时间和当前状态等信息，以及我们可以停用或启用当前的 Service Worker。

同时上述图中还包括了调试 Service Worker 的 [Push](https://developer.mozilla.org/en-US/docs/Web/API/PushEvent)（推送）、[Sync](https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope/sync_event#examples)（同步） 和 [Periodic Sync](https://developer.mozilla.org/en-US/docs/Web/API/PeriodicSyncEvent)（定期同步） 操作，分别对应浏览器 Service Worker 的这 3 个事件 API。如以下监听示例：

```javascript
self.addEventListener('sync', event => {
  if (event.tag == 'sync-messages') {
    event.waitUntil(sendMessage())
  }
})
```

当当前网页的资源被 Service Worker 缓存后我们可以在 `Cache Storage` 菜单中查看被缓存的数据。

![20211005192048.jpg](_attachment/img/0dad95e10637449c6b80a6b00b6e7c30_MD5.png)

选中右侧对应的资源，在下方可以直接预览资源的头信息和数据信息。同时我们也可以删除选中的缓存资源或通过路径进行搜索。

最后我们再来介绍 `Background Services ` 菜单集合，其包含了：

- Background Fetch
- Background Sync
- Notifications
- Payment Handler
- Periodic Background Sync
- Push Messaging

这些我们都把它们归属于后台服务 API，即当我们触发 Service Worker 对应的事件后这些菜单中会保存相应的记录信息，前提是我们需要开启它：

![20211005193303.jpg](_attachment/img/bfc0063e82e0f44449e6ff1e212f4cbb_MD5.png)

我们可以点击黑色小圆点开启对应的后台服务记录，开启后即便 Chrome DevTools 没有打开也可以记录 3 天的后台服务事件。

此时我们可以在 Service Workers 菜单下进行事件的触发测试，如下图所示：

![20211005195149.jpg](_attachment/img/0ccd8e542c9807074f9fdb79aaa256f3_MD5.png)

3 个事件触发按钮分别对应 Background Services 的 3 个后台服务，每次触发都会在对应的服务中生成记录信息，我们可以去对应的菜单中进行查看。

![20211005195608.jpg](_attachment/img/b52864dc8a1d3949bd7ad4601191b250_MD5.png)

右侧的列表区域我们可以看到每条记录的触发时间、事件类型、来源等信息，同时选择单独的数据可以在下方查看详细内容。

至此，Chrome 开发者工具中和浏览器缓存相关的 Application 控制面板的介绍便告一段落，虽然仍有一小部分使用场景很少的菜单没有进行讲解，比如 Web SQL 等，也无伤大雅。有兴趣的读者可以在本文的基础上进行进一步的实际操作和应用。

## 结语

正所谓“工欲善其事，必先利其器”。本文立足浏览器缓存，从工具角度介绍了 Chrome Application 控制面板中浏览器缓存开发和调试的相关菜单，进一步反应了工具在我们日常开发过程中的重要地位。
